{
  "name": "æ¥½å¤©å¸‚å ´ vs ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª ä¾¡æ ¼æ¯”è¼ƒ",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "hoursInterval": 6
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "â° å®šæœŸå®Ÿè¡Œ (6æ™‚é–“æ¯)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [0, 0]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "keyword",
              "name": "keyword",
              "value": "iPhone 15",
              "type": "string"
            },
            {
              "id": "applicationId",
              "name": "applicationId",
              "value": "YOUR_RAKUTEN_APP_ID",
              "type": "string"
            }
          ]
        }
      },
      "id": "set-params",
      "name": "ğŸ”§ æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [220, 0]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://app.rakuten.co.jp/services/api/IchibaItem/Search/20220601",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "applicationId",
              "value": "={{ $json.applicationId }}"
            },
            {
              "name": "keyword",
              "value": "={{ $json.keyword }}"
            },
            {
              "name": "hits",
              "value": "30"
            },
            {
              "name": "sort",
              "value": "+itemPrice"
            }
          ]
        },
        "options": {}
      },
      "id": "rakuten-api",
      "name": "ğŸ›’ æ¥½å¤©å¸‚å ´API",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 0]
    },
    {
      "parameters": {
        "jsCode": "// æ¥½å¤©APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰å•†å“ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º\nconst items = $input.first().json.Items || [];\n\nreturn items.map(item => {\n  const i = item.Item;\n  return {\n    json: {\n      source: 'æ¥½å¤©å¸‚å ´',\n      name: i.itemName,\n      price: i.itemPrice,\n      url: i.itemUrl,\n      shop: i.shopName,\n      availability: i.availability === 1 ? 'åœ¨åº«ã‚ã‚Š' : 'åœ¨åº«ãªã—'\n    }\n  };\n});"
      },
      "id": "parse-rakuten",
      "name": "ğŸ“¦ æ¥½å¤©ãƒ‡ãƒ¼ã‚¿æ•´å½¢",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 0]
    },
    {
      "parameters": {
        "method": "GET",
        "url": "https://www.mobile-ichiban.jp/products/list?category_id=&name=iPhone+15",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text"
            }
          }
        }
      },
      "id": "mobile-ichiban-request",
      "name": "ğŸ•·ï¸ ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªãƒšãƒ¼ã‚¸å–å¾—",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [440, 220]
    },
    {
      "parameters": {
        "jsCode": "// HTMLã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºï¼ˆã‚µãƒ³ãƒ—ãƒ« - å®Ÿéš›ã®ã‚µã‚¤ãƒˆæ§‹é€ ã«åˆã‚ã›ã¦èª¿æ•´ãŒå¿…è¦ï¼‰\nconst html = $input.first().json.data || '';\n\n// ç°¡æ˜“çš„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°\n// å®Ÿéš›ã®ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªã‚µã‚¤ãƒˆã®HTMLæ§‹é€ ã«åˆã‚ã›ã¦èª¿æ•´ã—ã¦ãã ã•ã„\nconst products = [];\n\n// ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã«ç½®ãæ›ãˆï¼‰\n// ä»¥ä¸‹ã¯å‹•ä½œç¢ºèªç”¨ã®ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã§ã™\nproducts.push({\n  source: 'ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª',\n  name: 'iPhone 15 128GB ä¸­å¤Aãƒ©ãƒ³ã‚¯',\n  price: 89800,\n  url: 'https://www.mobile-ichiban.jp/products/detail/xxxxx',\n  shop: 'ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª',\n  availability: 'åœ¨åº«ã‚ã‚Š'\n});\n\nreturn products.map(p => ({ json: p }));"
      },
      "id": "parse-mobile-ichiban",
      "name": "ğŸ“¦ ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªãƒ‡ãƒ¼ã‚¿æ•´å½¢",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 220]
    },
    {
      "parameters": {
        "mode": "combine",
        "mergeByFields": {
          "values": []
        },
        "combinationMode": "multiplex",
        "options": {}
      },
      "id": "merge-data",
      "name": "ğŸ”„ ãƒ‡ãƒ¼ã‚¿çµ±åˆ",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [880, 100]
    },
    {
      "parameters": {
        "jsCode": "// ä¾¡æ ¼æ¯”è¼ƒãƒ­ã‚¸ãƒƒã‚¯\nconst items = $input.all();\nconst results = [];\nconst threshold = 2000; // å·®é¡ã®é–¾å€¤ï¼ˆå††ï¼‰\n\n// æ¥½å¤©ã¨ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡\nconst rakutenItems = items.filter(i => i.json.source === 'æ¥½å¤©å¸‚å ´');\nconst mobileItems = items.filter(i => i.json.source === 'ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª');\n\n// å•†å“åã®é¡ä¼¼åº¦ã§æ¯”è¼ƒï¼ˆç°¡æ˜“ç‰ˆï¼‰\nfor (const mobile of mobileItems) {\n  for (const rakuten of rakutenItems) {\n    // å•†å“åã«å…±é€šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹ã‹ç¢ºèª\n    const mobileWords = mobile.json.name.toLowerCase().split(/\\s+/);\n    const rakutenWords = rakuten.json.name.toLowerCase().split(/\\s+/);\n    \n    // å…±é€šãƒ¯ãƒ¼ãƒ‰ãŒ2ã¤ä»¥ä¸Šã‚ã‚Œã°åŒä¸€å•†å“ã¨è¦‹ãªã™ï¼ˆç°¡æ˜“ç‰ˆï¼‰\n    const commonWords = mobileWords.filter(w => \n      rakutenWords.some(rw => rw.includes(w) || w.includes(rw))\n    );\n    \n    if (commonWords.length >= 2) {\n      const priceDiff = rakuten.json.price - mobile.json.price;\n      \n      if (Math.abs(priceDiff) >= threshold) {\n        results.push({\n          json: {\n            æ¯”è¼ƒæ—¥æ™‚: new Date().toISOString(),\n            å•†å“å_ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª: mobile.json.name,\n            å•†å“å_æ¥½å¤©: rakuten.json.name,\n            ä¾¡æ ¼_ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª: mobile.json.price,\n            ä¾¡æ ¼_æ¥½å¤©: rakuten.json.price,\n            å·®é¡: priceDiff,\n            ãŠå¾—ãªæ–¹: priceDiff > 0 ? 'ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª' : 'æ¥½å¤©å¸‚å ´',\n            URL_ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ª: mobile.json.url,\n            URL_æ¥½å¤©: rakuten.json.url\n          }\n        });\n      }\n    }\n  }\n}\n\nreturn results.length > 0 ? results : [{ json: { message: 'å·®é¡2000å††ä»¥ä¸Šã®å•†å“ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ' } }];"
      },
      "id": "compare-prices",
      "name": "ğŸ“Š ä¾¡æ ¼æ¯”è¼ƒ (å·®é¡2000å††ä»¥ä¸Š)",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 100]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "filter-has-diff",
              "leftValue": "={{ $json.å·®é¡ }}",
              "rightValue": "",
              "operator": {
                "type": "number",
                "operation": "exists"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "filter-results",
      "name": "âœ… çµæœãƒ•ã‚£ãƒ«ã‚¿",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [1320, 100]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "YOUR_GOOGLE_SHEET_ID",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "ä¾¡æ ¼æ¯”è¼ƒçµæœ",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {}
        },
        "options": {}
      },
      "id": "google-sheets",
      "name": "ğŸ“ Google Sheetså‡ºåŠ›",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [1540, 100]
    }
  ],
  "connections": {
    "â° å®šæœŸå®Ÿè¡Œ (6æ™‚é–“æ¯)": {
      "main": [
        [
          {
            "node": "ğŸ”§ æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”§ æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š": {
      "main": [
        [
          {
            "node": "ğŸ›’ æ¥½å¤©å¸‚å ´API",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ•·ï¸ ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªãƒšãƒ¼ã‚¸å–å¾—",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ›’ æ¥½å¤©å¸‚å ´API": {
      "main": [
        [
          {
            "node": "ğŸ“¦ æ¥½å¤©ãƒ‡ãƒ¼ã‚¿æ•´å½¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¦ æ¥½å¤©ãƒ‡ãƒ¼ã‚¿æ•´å½¢": {
      "main": [
        [
          {
            "node": "ğŸ”„ ãƒ‡ãƒ¼ã‚¿çµ±åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ•·ï¸ ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªãƒšãƒ¼ã‚¸å–å¾—": {
      "main": [
        [
          {
            "node": "ğŸ“¦ ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªãƒ‡ãƒ¼ã‚¿æ•´å½¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¦ ãƒ¢ãƒã‚¤ãƒ«ä¸€ç•ªãƒ‡ãƒ¼ã‚¿æ•´å½¢": {
      "main": [
        [
          {
            "node": "ğŸ”„ ãƒ‡ãƒ¼ã‚¿çµ±åˆ",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "ğŸ”„ ãƒ‡ãƒ¼ã‚¿çµ±åˆ": {
      "main": [
        [
          {
            "node": "ğŸ“Š ä¾¡æ ¼æ¯”è¼ƒ (å·®é¡2000å††ä»¥ä¸Š)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š ä¾¡æ ¼æ¯”è¼ƒ (å·®é¡2000å††ä»¥ä¸Š)": {
      "main": [
        [
          {
            "node": "âœ… çµæœãƒ•ã‚£ãƒ«ã‚¿",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… çµæœãƒ•ã‚£ãƒ«ã‚¿": {
      "main": [
        [
          {
            "node": "ğŸ“ Google Sheetså‡ºåŠ›",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2026-01-22T01:17:00.000Z",
  "versionId": "1"
}
